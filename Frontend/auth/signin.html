<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Sign In - TripGenie</title>
  <link rel="stylesheet" href="styles/signin.css">
  <link rel="stylesheet" href="../styles/auth.css">
</head>

<body>
  <script>
    // Redirect if already logged in
    window.onload = function () {
      const currentUser = localStorage.getItem('currentUser');
      if (currentUser) {
        window.location.href = '../index.html';
      }
    }
  </script>
  <div class="container">
    <h2>Sign In</h2>
    <input type="text" id="signin-username" placeholder="Username">
    <input type="password" id="signin-password" placeholder="Password">
    <button onclick="signin()">Sign In</button>

    <div class="link">
      Don't have an account? <a href="signup.html">Sign Up</a>
    </div>
  </div>

  <!-- Add Modal HTML -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <h3 class="modal-title" id="modal-title"></h3>
      <p class="modal-message" id="modal-message"></p>
      <button class="modal-button" onclick="closeModal()">OK</button>
    </div>
  </div>

  <script>
    function showModal(title, message, type = 'success') {
      const modal = document.getElementById('modal');
      const modalTitle = document.getElementById('modal-title');
      const modalMessage = document.getElementById('modal-message');

      modalTitle.textContent = title;
      modalMessage.textContent = message;
      modal.classList.add('show', type);
    }

    function closeModal() {
      const modal = document.getElementById('modal');
      modal.classList.remove('show', 'success', 'error');
      if (modal.dataset.redirect) {
        window.location.href = modal.dataset.redirect;
      }
    }

    function signin() {
      const username = document.getElementById('signin-username').value;
      const password = document.getElementById('signin-password').value;
      const storedPassword = localStorage.getItem(username);

      if (!username || !password) {
        showModal('Error', 'Please fill in all fields', 'error');
        return;
      }

      if (!storedPassword) {
        showModal('Error', 'User not found', 'error');
        return;
      }

      if (storedPassword === password) {
        localStorage.setItem('currentUser', username);
        const modal = document.getElementById('modal');
        modal.dataset.redirect = '../index.html';
        showModal('Success', 'Sign in successful! Redirecting to home...');
      } else {
        showModal('Error', 'Invalid credentials', 'error');
      }
    }
  </script>
  <script src="../scripts/modal.js"></script>
  <script src="../scripts/auth.js"></script>
</body>

</html>